(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))p(l);new MutationObserver(l=>{for(const m of l)if(m.type==="childList")for(const s of m.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&p(s)}).observe(document,{childList:!0,subtree:!0});function g(l){const m={};return l.integrity&&(m.integrity=l.integrity),l.referrerPolicy&&(m.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?m.credentials="include":l.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function p(l){if(l.ep)return;l.ep=!0;const m=g(l);fetch(l.href,m)}})();var q={},ie;function le(){return ie||(ie=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.countMap=t.Random=t.phi=t.radiansPerDegree=t.degreesPerRadian=t.FULL_CIRCLE=t.FIGURE_SPACE=t.NON_BREAKING_SPACE=t.MIN_DATE=t.MAX_DATE=t.csvStringToArray=void 0,t.assertClass=o,t.assertNonNullable=g,t.sleep=p,t.testXml=l,t.parseXml=m,t.followPath=s,t.getAttribute=E,t.parseFloatX=w,t.parseIntX=T,t.parseTimeT=N,t.pickAny=k,t.pick=F,t.take=c,t.filterMap=a,t.makePromise=u,t.dateIsValid=h,t.angleBetween=S,t.positiveModulo=L,t.rotateArray=R,t.rectUnion=te,t.rectAddPoint=Ee,t.dateToFileName=we,t.lerp=ye,t.assertFinite=Se,t.shuffleArray=Le,t.zip=Te,t.count=Me,t.initializedArray=ne,t.sum=ve,t.makeLinear=be,t.makeBoundedLinear=Ce,t.polarToRectangular=Ie,t.permutations=re,t.gcd=X,t.lcm=Ne;function o(e,n,i="Assertion Failed."){const r=d=>{throw new Error(`${i}  Expected type:  ${n.name}.  Found type:  ${d}.`)};if(e===null)r("null");else if(typeof e!="object")r(typeof e);else if(!(e instanceof n))r(e.constructor.name);else return e;throw new Error("wtf")}function g(e){if(e==null)throw new Error("wtf");return e}function p(e){return new Promise(n=>{setTimeout(n,e)})}function l(e){const i=new DOMParser().parseFromString(e,"application/xml");for(const r of Array.from(i.querySelectorAll("parsererror")))if(r instanceof HTMLElement)return{error:r};return{parsed:i}}function m(e){if(e!==void 0){const{parsed:n}=l(e);return n?.documentElement}}function s(e,...n){for(const i of n){if(e===void 0)return;if(typeof i=="number")e=e.children[i];else{const r=e.getElementsByTagName(i);if(r.length!=1)return;e=r[0]}}return e}function E(e,n,...i){if(n=s(n,...i),n!==void 0&&n.hasAttribute(e))return n.getAttribute(e)??void 0}function w(e){if(e==null)return;const n=+e;if(isFinite(n))return n}function T(e){const n=w(e);if(n!==void 0)return n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER||n!=Math.floor(n)?void 0:n}function N(e){if(typeof e=="string"&&(e=T(e)),e!=null&&!(e<=0))return new Date(e*1e3)}const A=e=>{const n=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,i=[[]];let r;for(;r=n.exec(e);)r[1].length&&r[1]!==","&&i.push([]),i[i.length-1].push(r[2]!==void 0?r[2].replace(/""/g,'"'):r[3]);return i};t.csvStringToArray=A;function k(e){const n=e.values().next();if(!n.done)return n.value}function F(e){if(e.length==0)throw new Error("wtf");return e[Math.random()*e.length|0]}function c(e){if(e.length<1)throw new Error("wtf");const n=Math.random()*e.length|0;return e.splice(n,1)[0]}function a(e,n){const i=[];return e.forEach((r,d)=>{const f=n(r,d);f!==void 0&&i.push(f)}),i}function u(){let e,n;return{promise:new Promise((r,d)=>{e=r,n=d}),resolve:e,reject:n}}t.MAX_DATE=new Date(864e13),t.MIN_DATE=new Date(-864e13);function h(e){return isFinite(e.getTime())}t.NON_BREAKING_SPACE=" ",t.FIGURE_SPACE=" ",t.FULL_CIRCLE=2*Math.PI,t.degreesPerRadian=360/t.FULL_CIRCLE,t.radiansPerDegree=t.FULL_CIRCLE/360,t.phi=(1+Math.sqrt(5))/2;function S(e,n){const i=L(e,t.FULL_CIRCLE);let d=L(n,t.FULL_CIRCLE)-i;const f=t.FULL_CIRCLE/2;if(d>f?d-=t.FULL_CIRCLE:d<-f&&(d+=t.FULL_CIRCLE),Math.abs(d)>f)throw new Error("wtf");return d}function L(e,n){const i=e%n;return i<0?i+Math.abs(n):i}function R(e,n){if((n|0)!=n)throw new Error(`invalid input: ${n}`);return n=L(n,e.length),n==0?e:[...e.slice(n),...e.slice(0,n)]}class pe{constructor(){throw new Error("wtf")}static sfc32(n,i,r,d){function f(){n|=0,i|=0,r|=0,d|=0;let I=(n+i|0)+d|0;return d=d+1|0,n=i^i>>>9,i=r+(r<<3)|0,r=r<<21|r>>>11,r=r+I|0,(I>>>0)/4294967296}const v=f;return Object.defineProperty(v,"currentSeed",{get(){return JSON.stringify([n,i,r,d])}}),v}static#e=42;static seedIsValid(n){try{return this.create(n),!0}catch{return!1}}static create(n=this.newSeed()){console.info(n);const i=JSON.parse(n);if(!(i instanceof Array))throw new Error("invalid input");if(i.length!=4)throw new Error("invalid input");const[r,d,f,v]=i;if(!(typeof r=="number"&&typeof d=="number"&&typeof f=="number"&&typeof v=="number"))throw new Error("invalid input");return this.sfc32(r,d,f,v)}static newSeed(){const n=[];return n.push(Date.now()|0),n.push(this.#e++|0),n.push(Math.random()*2**31|0),n.push(performance.now()*1e4|0),JSON.stringify(n)}static fromString(n){try{return this.create(n)}catch{return this.create(this.anyStringToSeed(n))}}static anyStringToSeed(n){function i(f,v){return(f<<v|f>>>32-v)>>>0}const r=[2654435769,608135816,2242054355,320440878];return new TextEncoder().encode(n).forEach(f=>{r[0]^=f,r[0]=i(r[0],3),r[1]^=f,r[1]=i(r[1],5),r[2]^=f,r[2]=i(r[2],7),r[3]^=f,r[3]=i(r[3],11)}),r[0]^=i(r[1],7),r[1]^=i(r[2],11),r[2]^=i(r[3],13),r[3]^=i(r[0],17),JSON.stringify(r)}static test(){const r=[this.create()];for(;r.length<=10;){for(let f=0;f<20;f++){const v=r.map(I=>I());for(let I=1;I<v.length;I++)if(v[I]!==v[0]){debugger;throw new Error("wtf")}}const d=F(r).currentSeed;r.forEach(f=>{if(f.currentSeed!=d){debugger;throw new Error("wtf")}}),r.push(this.create(d))}}}t.Random=pe;function te(e,n){const i=Math.min(e.x,n.x),r=Math.min(e.y,n.y),d=Math.max(e.x+e.width,n.x+n.width),f=Math.max(e.y+e.height,n.y+n.height),v=d-i,I=f-r;return{x:i,y:r,width:v,height:I}}function Ee(e,n,i){return te(e,{x:n,y:i,width:0,height:0})}function we(e){return isNaN(e.getTime())?"0000⸱00⸱00 00⦂00⦂00":`${e.getFullYear().toString().padStart(4,"0")}⸱${(e.getMonth()+1).toString().padStart(2,"0")}⸱${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}⦂${e.getMinutes().toString().padStart(2,"0")}⦂${e.getSeconds().toString().padStart(2,"0")}`}function ye(e,n,i){return e+(n-e)*i}function Se(...e){e.forEach(n=>{if(!Number.isFinite(n))throw new Error("wtf")})}function Le(e){for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}function*Te(...e){const n=e.map(i=>i[Symbol.iterator]());for(;;){const i=n.map(r=>r.next());if(i.some(({done:r})=>r))break;yield i.map(({value:r})=>r)}}function*Me(e=0,n=1/0,i=1){for(let r=e;r<n;r+=i)yield r}function ne(e,n){const i=[];for(let r=0;r<e;r++)i.push(n(r));return i}t.countMap=ne;function ve(e){return e.reduce((n,i)=>n+i,0)}function be(e,n,i,r){const d=(r-n)/(i-e);return function(f){return(f-e)*d+n}}function Ce(e,n,i,r){i<e&&([e,n,i,r]=[i,r,e,n]);const d=(r-n)/(i-e);return function(f){return f<=e?n:f>=i?r:(f-e)*d+n}}function Ie(e,n){return{x:Math.cos(n)*e,y:Math.sin(n)*e}}function*re(e,n=[]){if(e.length==0)yield n;else for(let i=0;i<e.length;i++){const r=e[i],d=[...n,r],f=[...e.slice(0,i),...e.slice(i+1)];yield*re(f,d)}}function X(e,n){return n?X(n,e%n):e}function Ne(e,n){return e*n/X(e,n)}})(q)),q}var C=le(),M={},oe;function Ae(){if(oe)return M;oe=1,Object.defineProperty(M,"__esModule",{value:!0}),M.AnimationLoop=void 0,M.getById=o,M.selectorQueryAll=g,M.querySelectorAll=p,M.selectorQuery=l,M.querySelector=m,M.loadDateTimeLocal=s,M.getBlobFromCanvas=E,M.getAudioBalanceControl=w,M.getHashInfo=T,M.createElementFromHTML=N,M.download=A,M.getDataUrl=F;const t=le();function o(c,a){const u=document.getElementById(c);if(!u)throw new Error("Could not find element with id "+c+".  Expected type:  "+a.name);if(u instanceof a)return u;throw new Error("Element with id "+c+" has type "+u.constructor.name+".  Expected type:  "+a.name)}function g(c,a,u=1,h=1/0,S=document){const L=[];if(S.querySelectorAll(c).forEach(R=>{L.push((0,t.assertClass)(R,a))}),L.length<u||L.length>h)throw new Error(`Expecting "${c}" to return [${u} - ${h}] instances of ${a.name}, found ${L.length}.`);return L}function p(c,a,u=1,h=1/0,S=document){const L=[];if(S.querySelectorAll(c).forEach(R=>{L.push((0,t.assertClass)(R,a))}),L.length<u||L.length>h)throw new Error(`Expecting "${c}" to return [${u} - ${h}] instances of ${a.name}, found ${L.length}.`);return L}function l(c,a,u=document){return g(c,a,1,1,u)[0]}function m(c,a,u=document){return p(c,a,1,1,u)[0]}function s(c,a,u="milliseconds"){let h;switch(u){case"minutes":{h=a.getSeconds()*1e3+a.getMilliseconds();break}case"seconds":{h=a.getMilliseconds();break}case"milliseconds":{h=0;break}default:throw new Error("wtf")}c.valueAsNumber=+a-a.getTimezoneOffset()*6e4-h}function E(c){const{reject:a,resolve:u,promise:h}=(0,t.makePromise)();return c.toBlob(S=>{S?u(S):a(new Error("blob is null!"))}),h}function w(c){const a=new AudioContext,u=a.createMediaElementSource(c),h=new StereoPannerNode(a,{pan:0});return u.connect(h).connect(a.destination),S=>{h.pan.value=S}}function T(){const c=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(h=>{const S=h.split("=",2);if(S.length==2){const L=decodeURIComponent(S[0]),R=decodeURIComponent(S[1]);c.set(L,R)}}),c}function N(c,a){var u=document.createElement("div");return u.innerHTML=c.trim(),(0,t.assertClass)(u.firstChild,a,"createElementFromHTML:")}function A(c,a){var u=document.createElement("a");if(u.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(a)),u.setAttribute("download",c),document.createEvent){var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!0),u.dispatchEvent(h)}else u.click()}class k{onWake;constructor(a){this.onWake=a,this.callback=this.callback.bind(this),requestAnimationFrame(this.callback)}#e=!1;cancel(){this.#e=!0}callback(a){this.#e||(requestAnimationFrame(this.callback),this.onWake(a))}}M.AnimationLoop=k;async function F(c){const a=document.createElement("img");a.src=c,await a.decode();const u=a.naturalHeight,h=a.naturalWidth;if(u==0||h==0)throw new Error("problem with image");const S=document.createElement("canvas");S.width=h,S.height=u;const L=S.getContext("2d");if(!L)throw new Error("wtf");return L.drawImage(a,0,0,S.width,S.height),S.toDataURL()}return M}var y=Ae();const Fe=.2,j=1,H=1,O=3.25,Y=2,W=8,V=2.5,Re=W-Y,ue=W-j,Pe=W-Fe;function se(t){return(t-V)*Pe/ue+V}function U(t){return(t-V)*Re/ue+V}function ke(){const t=y.getById("sample-polygon",SVGPolygonElement),o=`${j},${H} ${j},${O} ${Y},${U(O)} ${Y},${U(H)}`;t.setAttribute("points",o);const g=y.getById("top-fixed",SVGLineElement);g.y1.baseVal.value=se(H);const p=y.getById("bottom-fixed",SVGLineElement);p.y1.baseVal.value=se(O);const l=y.getById("far-text",SVGTextElement),m=(H+O)/2;l.style.setProperty("--center-y",`${m}px`),y.getById("near-text",SVGTextElement).style.setProperty("--center-y",`${U(m)}px`)}ke();const Be=y.getById("to-near",SVGLineElement),_e=y.getById("to-far",SVGLineElement);function fe(t){const o=U(t);_e.y1.baseVal.value=t,Be.y1.baseVal.value=o}window.setMeasurementAngle=fe;const $e=C.Random.fromString("Random1"),_=C.initializedArray(20,()=>$e()*4+.5);_.push;const He=3e3,z=250,ae=He+z;function Oe(t){const o=Math.floor(t/ae),g=_[o%_.length],p=_[(o+1)%_.length],l=t-o*ae,m=l<z?C.lerp(g,p,l/z):p;fe(m)}new y.AnimationLoop(Oe);function J(t){if(t==null||t.trim()==="")return;const o=+t;if(isFinite(o))return o}function P(t){const o=J(t);if(o!==void 0)return o>Number.MAX_SAFE_INTEGER||o<Number.MIN_SAFE_INTEGER||o!=Math.floor(o)?void 0:o}const Q=y.getById("d-far",HTMLInputElement),K=y.getById("d-near",HTMLInputElement),Z=y.getById("progress",HTMLInputElement),de=y.getById("precision",HTMLSelectElement),me=y.getById("split-count",HTMLSelectElement),D=y.getById("split-result",HTMLTableElement),ge=y.getById("larger-count",HTMLSelectElement),De=y.getById("larger-copies",HTMLSpanElement),he=y.getById("smaller-count",HTMLSelectElement),Ue=y.getById("smaller-copies",HTMLSpanElement),B=y.getById("extended-result",HTMLTableElement),Ge=y.getById("smallest-legal-progress",HTMLSpanElement),ce=y.getById("specific-point-result",HTMLTableCellElement);function b(t,o){function g(){o.innerText="invalid"}function p(){return!(t===void 0||!isFinite(t))}function l(w,T){return w.toLocaleString("en-US",{minimumFractionDigits:T,maximumFractionDigits:T,useGrouping:!0})}function m(w){return w.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:20,useGrouping:!0})}function s(w){if(!p())g();else{const T=l(t,w);o.innerText=T}}function E(w){if(!p())g();else{let T=w;const N=Math.round(t*T);let A=Math.abs(N)%T;const k=(Math.abs(N)-A)/T;if(A==0)s(0);else{for(;A%2==0;)A/=2,T/=2;const F=document.createElement("span");F.classList.add("numerator"),F.innerText=A.toString();const c=document.createElement("span");c.classList.add("denominator"),c.innerText=T.toString(),o.innerHTML="",N<0&&o.append("-"),k!=0&&o.append(l(k,0)," "),o.append(F,"/",c)}}}if(!p())g();else switch(de.selectedOptions[0].value){case"0.1":{s(1);break}case"0.01":{s(2);break}case"0.001":{s(3);break}case"0.0001":{s(4);break}case"1/2":{E(2);break}case"1/4":{E(4);break}case"1/8":{E(8);break}case"1/16":{E(16);break}case"1/32":{E(32);break}case"1/64":{E(64);break}case"full":{o.innerText=m(C.assertNonNullable(t));break}default:throw new Error(`wtf (${t})`)}}function $(t,o,g){if(t<=o||o<=0)return;const p=(1-g)*o+g*t;if(!(p<=0))return t*o/p}function Ve(t,o){if(!(t===void 0||o===void 0)&&!(t<=o||o<=0))return o/(o-t)}function x(t){const g=/^ *(-)?(\d+ +)?(\d+) *\/ *(\d+) *$/.exec(t);if(g){const[,p,l,m,s]=g,E=l===void 0?0:C.assertNonNullable(P(l)),w=C.assertNonNullable(P(m)),T=C.assertNonNullable(P(s)),N=p==="-"?-1:1;return T==0?void 0:N*(E+w/T)}else return J(t)}function G(t){const o=t.value,g=x(o);return g===void 0?t.style.backgroundColor="pink":t.style.backgroundColor="",g}function ee(){const t=G(Q),o=G(K),g=G(Z);b(void 0,ce),b(Ve(t,o),Ge),D.innerHTML="",B.innerHTML="";function p(s,E){const w=s==1?"copy":"copies";E.innerText=w}const l=C.assertNonNullable(P(ge.selectedOptions[0].value));p(l,De);const m=C.assertNonNullable(P(he.selectedOptions[0].value));if(p(m,Ue),!(t===void 0||o===void 0)){{let s=D.insertRow();s.insertCell().innerText="Far",b(t,s.insertCell());const E=C.assertNonNullable(P(me.selectedOptions[0].value));for(let w=1;w<E;w++)s=D.insertRow(),s.insertCell().innerText=w.toString(),b($(t,o,w/E),s.insertCell());s=D.insertRow(),s.insertCell().innerText="Near",b(o,s.insertCell())}for(let s=l;s>0;s--){const E=B.insertRow();E.insertCell().innerText=s.toString(),b($(t,o,-s),E.insertCell())}{const s=B.insertRow();s.insertCell().innerText="Far",b(t,s.insertCell())}{const s=B.insertRow();s.insertCell().innerText="Near",b(o,s.insertCell())}for(let s=0;s<m;s++){const E=B.insertRow();E.insertCell().innerText=(s+1).toString(),b($(t,o,s+2),E.insertCell())}b(g===void 0?void 0:$(t,o,g),ce)}}ee();[Q,K,Z,de,me,ge,he].forEach(t=>{t.addEventListener("input",ee)});y.querySelectorAll("[data-fraction]",HTMLSpanElement).forEach(t=>{const o=x(C.assertNonNullable(t.dataset.fraction));o===void 0&&console.error(t),b(o,t)});window.PHIL={dFarInput:Q,dNearInput:K,progressInput:Z,parseFraction:x,getNumberValue:G,findPerspectivePoint:$,updateDisplay:ee,parseFloatX:J,parseIntX:P};
