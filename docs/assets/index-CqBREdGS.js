(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))f(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const y of d.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&f(y)}).observe(document,{childList:!0,subtree:!0});function g(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function f(l){if(l.ep)return;l.ep=!0;const d=g(l);fetch(l.href,d)}})();var H={},z;function V(){return z||(z=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.countMap=n.Random=n.phi=n.radiansPerDegree=n.degreesPerRadian=n.FULL_CIRCLE=n.FIGURE_SPACE=n.NON_BREAKING_SPACE=n.MIN_DATE=n.MAX_DATE=n.csvStringToArray=void 0,n.assertClass=m,n.assertNonNullable=g,n.sleep=f,n.testXml=l,n.parseXml=d,n.followPath=y,n.getAttribute=b,n.parseFloatX=L,n.parseIntX=M,n.parseTimeT=T,n.pickAny=_,n.pick=F,n.take=u,n.filterMap=o,n.makePromise=s,n.dateIsValid=h,n.angleBetween=w,n.positiveModulo=p,n.rotateArray=A,n.rectUnion=q,n.rectAddPoint=x,n.dateToFileName=ee,n.lerp=te,n.assertFinite=ne,n.shuffleArray=re,n.zip=ie,n.count=oe,n.initializedArray=j,n.sum=se,n.makeLinear=ce,n.makeBoundedLinear=ae,n.polarToRectangular=le,n.permutations=G,n.gcd=B,n.lcm=ue;function m(e,t,i="Assertion Failed."){const r=a=>{throw new Error(`${i}  Expected type:  ${t.name}.  Found type:  ${a}.`)};if(e===null)r("null");else if(typeof e!="object")r(typeof e);else if(!(e instanceof t))r(e.constructor.name);else return e;throw new Error("wtf")}function g(e){if(e==null)throw new Error("wtf");return e}function f(e){return new Promise(t=>{setTimeout(t,e)})}function l(e){const i=new DOMParser().parseFromString(e,"application/xml");for(const r of Array.from(i.querySelectorAll("parsererror")))if(r instanceof HTMLElement)return{error:r};return{parsed:i}}function d(e){if(e!==void 0){const{parsed:t}=l(e);return t?.documentElement}}function y(e,...t){for(const i of t){if(e===void 0)return;if(typeof i=="number")e=e.children[i];else{const r=e.getElementsByTagName(i);if(r.length!=1)return;e=r[0]}}return e}function b(e,t,...i){if(t=y(t,...i),t!==void 0&&t.hasAttribute(e))return t.getAttribute(e)??void 0}function L(e){if(e==null)return;const t=+e;if(isFinite(t))return t}function M(e){const t=L(e);if(t!==void 0)return t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER||t!=Math.floor(t)?void 0:t}function T(e){if(typeof e=="string"&&(e=M(e)),e!=null&&!(e<=0))return new Date(e*1e3)}const P=e=>{const t=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,i=[[]];let r;for(;r=t.exec(e);)r[1].length&&r[1]!==","&&i.push([]),i[i.length-1].push(r[2]!==void 0?r[2].replace(/""/g,'"'):r[3]);return i};n.csvStringToArray=P;function _(e){const t=e.values().next();if(!t.done)return t.value}function F(e){if(e.length==0)throw new Error("wtf");return e[Math.random()*e.length|0]}function u(e){if(e.length<1)throw new Error("wtf");const t=Math.random()*e.length|0;return e.splice(t,1)[0]}function o(e,t){const i=[];return e.forEach((r,a)=>{const c=t(r,a);c!==void 0&&i.push(c)}),i}function s(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}n.MAX_DATE=new Date(864e13),n.MIN_DATE=new Date(-864e13);function h(e){return isFinite(e.getTime())}n.NON_BREAKING_SPACE=" ",n.FIGURE_SPACE=" ",n.FULL_CIRCLE=2*Math.PI,n.degreesPerRadian=360/n.FULL_CIRCLE,n.radiansPerDegree=n.FULL_CIRCLE/360,n.phi=(1+Math.sqrt(5))/2;function w(e,t){const i=p(e,n.FULL_CIRCLE);let a=p(t,n.FULL_CIRCLE)-i;const c=n.FULL_CIRCLE/2;if(a>c?a-=n.FULL_CIRCLE:a<-c&&(a+=n.FULL_CIRCLE),Math.abs(a)>c)throw new Error("wtf");return a}function p(e,t){const i=e%t;return i<0?i+Math.abs(t):i}function A(e,t){if((t|0)!=t)throw new Error(`invalid input: ${t}`);return t=p(t,e.length),t==0?e:[...e.slice(t),...e.slice(0,t)]}class Z{constructor(){throw new Error("wtf")}static sfc32(t,i,r,a){function c(){t|=0,i|=0,r|=0,a|=0;let I=(t+i|0)+a|0;return a=a+1|0,t=i^i>>>9,i=r+(r<<3)|0,r=r<<21|r>>>11,r=r+I|0,(I>>>0)/4294967296}const S=c;return Object.defineProperty(S,"currentSeed",{get(){return JSON.stringify([t,i,r,a])}}),S}static#e=42;static seedIsValid(t){try{return this.create(t),!0}catch{return!1}}static create(t=this.newSeed()){console.info(t);const i=JSON.parse(t);if(!(i instanceof Array))throw new Error("invalid input");if(i.length!=4)throw new Error("invalid input");const[r,a,c,S]=i;if(!(typeof r=="number"&&typeof a=="number"&&typeof c=="number"&&typeof S=="number"))throw new Error("invalid input");return this.sfc32(r,a,c,S)}static newSeed(){const t=[];return t.push(Date.now()|0),t.push(this.#e++|0),t.push(Math.random()*2**31|0),t.push(performance.now()*1e4|0),JSON.stringify(t)}static fromString(t){try{return this.create(t)}catch{return this.create(this.anyStringToSeed(t))}}static anyStringToSeed(t){function i(c,S){return(c<<S|c>>>32-S)>>>0}const r=[2654435769,608135816,2242054355,320440878];return new TextEncoder().encode(t).forEach(c=>{r[0]^=c,r[0]=i(r[0],3),r[1]^=c,r[1]=i(r[1],5),r[2]^=c,r[2]=i(r[2],7),r[3]^=c,r[3]=i(r[3],11)}),r[0]^=i(r[1],7),r[1]^=i(r[2],11),r[2]^=i(r[3],13),r[3]^=i(r[0],17),JSON.stringify(r)}static test(){const r=[this.create()];for(;r.length<=10;){for(let c=0;c<20;c++){const S=r.map(I=>I());for(let I=1;I<S.length;I++)if(S[I]!==S[0]){debugger;throw new Error("wtf")}}const a=F(r).currentSeed;r.forEach(c=>{if(c.currentSeed!=a){debugger;throw new Error("wtf")}}),r.push(this.create(a))}}}n.Random=Z;function q(e,t){const i=Math.min(e.x,t.x),r=Math.min(e.y,t.y),a=Math.max(e.x+e.width,t.x+t.width),c=Math.max(e.y+e.height,t.y+t.height),S=a-i,I=c-r;return{x:i,y:r,width:S,height:I}}function x(e,t,i){return q(e,{x:t,y:i,width:0,height:0})}function ee(e){return isNaN(e.getTime())?"0000⸱00⸱00 00⦂00⦂00":`${e.getFullYear().toString().padStart(4,"0")}⸱${(e.getMonth()+1).toString().padStart(2,"0")}⸱${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}⦂${e.getMinutes().toString().padStart(2,"0")}⦂${e.getSeconds().toString().padStart(2,"0")}`}function te(e,t,i){return e+(t-e)*i}function ne(...e){e.forEach(t=>{if(!Number.isFinite(t))throw new Error("wtf")})}function re(e){for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function*ie(...e){const t=e.map(i=>i[Symbol.iterator]());for(;;){const i=t.map(r=>r.next());if(i.some(({done:r})=>r))break;yield i.map(({value:r})=>r)}}function*oe(e=0,t=1/0,i=1){for(let r=e;r<t;r+=i)yield r}function j(e,t){const i=[];for(let r=0;r<e;r++)i.push(t(r));return i}n.countMap=j;function se(e){return e.reduce((t,i)=>t+i,0)}function ce(e,t,i,r){const a=(r-t)/(i-e);return function(c){return(c-e)*a+t}}function ae(e,t,i,r){i<e&&([e,t,i,r]=[i,r,e,t]);const a=(r-t)/(i-e);return function(c){return c<=e?t:c>=i?r:(c-e)*a+t}}function le(e,t){return{x:Math.cos(t)*e,y:Math.sin(t)*e}}function*G(e,t=[]){if(e.length==0)yield t;else for(let i=0;i<e.length;i++){const r=e[i],a=[...t,r],c=[...e.slice(0,i),...e.slice(i+1)];yield*G(c,a)}}function B(e,t){return t?B(t,e%t):e}function ue(e,t){return e*t/B(e,t)}})(H)),H}var v=V(),E={},J;function de(){if(J)return E;J=1,Object.defineProperty(E,"__esModule",{value:!0}),E.AnimationLoop=void 0,E.getById=m,E.selectorQueryAll=g,E.querySelectorAll=f,E.selectorQuery=l,E.querySelector=d,E.loadDateTimeLocal=y,E.getBlobFromCanvas=b,E.getAudioBalanceControl=L,E.getHashInfo=M,E.createElementFromHTML=T,E.download=P,E.getDataUrl=F;const n=V();function m(u,o){const s=document.getElementById(u);if(!s)throw new Error("Could not find element with id "+u+".  Expected type:  "+o.name);if(s instanceof o)return s;throw new Error("Element with id "+u+" has type "+s.constructor.name+".  Expected type:  "+o.name)}function g(u,o,s=1,h=1/0,w=document){const p=[];if(w.querySelectorAll(u).forEach(A=>{p.push((0,n.assertClass)(A,o))}),p.length<s||p.length>h)throw new Error(`Expecting "${u}" to return [${s} - ${h}] instances of ${o.name}, found ${p.length}.`);return p}function f(u,o,s=1,h=1/0,w=document){const p=[];if(w.querySelectorAll(u).forEach(A=>{p.push((0,n.assertClass)(A,o))}),p.length<s||p.length>h)throw new Error(`Expecting "${u}" to return [${s} - ${h}] instances of ${o.name}, found ${p.length}.`);return p}function l(u,o,s=document){return g(u,o,1,1,s)[0]}function d(u,o,s=document){return f(u,o,1,1,s)[0]}function y(u,o,s="milliseconds"){let h;switch(s){case"minutes":{h=o.getSeconds()*1e3+o.getMilliseconds();break}case"seconds":{h=o.getMilliseconds();break}case"milliseconds":{h=0;break}default:throw new Error("wtf")}u.valueAsNumber=+o-o.getTimezoneOffset()*6e4-h}function b(u){const{reject:o,resolve:s,promise:h}=(0,n.makePromise)();return u.toBlob(w=>{w?s(w):o(new Error("blob is null!"))}),h}function L(u){const o=new AudioContext,s=o.createMediaElementSource(u),h=new StereoPannerNode(o,{pan:0});return s.connect(h).connect(o.destination),w=>{h.pan.value=w}}function M(){const u=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(h=>{const w=h.split("=",2);if(w.length==2){const p=decodeURIComponent(w[0]),A=decodeURIComponent(w[1]);u.set(p,A)}}),u}function T(u,o){var s=document.createElement("div");return s.innerHTML=u.trim(),(0,n.assertClass)(s.firstChild,o,"createElementFromHTML:")}function P(u,o){var s=document.createElement("a");if(s.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o)),s.setAttribute("download",u),document.createEvent){var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!0),s.dispatchEvent(h)}else s.click()}class _{onWake;constructor(o){this.onWake=o,this.callback=this.callback.bind(this),requestAnimationFrame(this.callback)}#e=!1;cancel(){this.#e=!0}callback(o){this.#e||(requestAnimationFrame(this.callback),this.onWake(o))}}E.AnimationLoop=_;async function F(u){const o=document.createElement("img");o.src=u,await o.decode();const s=o.naturalHeight,h=o.naturalWidth;if(s==0||h==0)throw new Error("problem with image");const w=document.createElement("canvas");w.width=h,w.height=s;const p=w.getContext("2d");if(!p)throw new Error("wtf");return p.drawImage(o,0,0,w.width,w.height),w.toDataURL()}return E}var C=de();const O=C.getById("d-far",HTMLInputElement),D=C.getById("d-near",HTMLInputElement),U=C.getById("progress",HTMLInputElement),W=C.getById("precision",HTMLSelectElement),K=C.getById("split-count",HTMLSelectElement),k=C.getById("split-result",HTMLTableElement),fe=C.getById("larger-count",HTMLSelectElement),he=C.getById("smaller-count",HTMLSelectElement);C.getById("extended-result",HTMLTableElement);const Q=C.getById("specific-point-result",HTMLTableCellElement);function N(n,m){console.log(n,m);function g(l){const d=n.toFixed(l);m.innerText=d}function f(l){const d=n%1,y=n-d;let b=l,L=Math.abs(Math.round(d*b));if(L==0)g(0);else{for(;L%2==0;)L/=2,b/=2;const M=document.createElement("span");M.classList.add("numerator"),M.innerText=L.toString();const T=document.createElement("span");T.classList.add("denominator"),T.innerText=b.toString(),m.innerHTML="",m.append(y.toString()," ",M,"/",T)}}if(n===void 0)m.innerHTML="";else{const d=W.selectedOptions[0].value;switch(d){case"0.1":{g(1);break}case"0.01":{g(2);break}case"0.001":{g(3);break}case"0.0001":{g(4);break}case"1/2":{f(2);break}case"1/4":{f(4);break}case"1/8":{f(8);break}case"1/16":{f(16);break}case"1/32":{f(32);break}case"1/64":{f(64);break}default:throw new Error(`wtf (${d})`)}}}function $(n,m,g){return n*m/((1-g)*m+g*n)}function Y(n){const g=/^ *(-)?(\d+ +)?(\d+) *\/ *(\d+) *$/.exec(n);if(g){const[,f,l,d,y]=g,b=l===void 0?0:v.assertNonNullable(v.parseIntX(l)),L=v.assertNonNullable(v.parseIntX(d)),M=v.assertNonNullable(v.parseIntX(y)),T=f==="-"?-1:1;return M==0?void 0:T*(b+L/M)}else return v.parseFloatX(n)}function R(n){const m=n.value,g=Y(m);return g===void 0?n.style.backgroundColor="pink":n.style.backgroundColor="",g}function X(){const n=R(O),m=R(D),g=R(U);if(N(void 0,Q),k.innerHTML="",!(n===void 0||m===void 0)){{let f=k.insertRow();f.insertCell().innerText="Far",N(n,f.insertCell());const l=v.assertNonNullable(v.parseIntX(K.selectedOptions[0].value));for(let d=1;d<l;d++)f=k.insertRow(),f.insertCell().innerText=d.toString(),N($(n,m,d/l),f.insertCell());f=k.insertRow(),f.insertCell().innerText="Near",N(m,f.insertCell())}g!==void 0&&N($(n,m,g),Q)}}X();[O,D,U,W,K,fe,he].forEach(n=>{n.addEventListener("input",X)});window.PHIL={dFarInput:O,dNearInput:D,progressInput:U,parseFraction:Y,getNumberValue:R,findPerspectivePoint:$,updateDisplay:X};
