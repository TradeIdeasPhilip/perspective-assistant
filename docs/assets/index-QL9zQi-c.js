(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))S(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const o of h.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&S(o)}).observe(document,{childList:!0,subtree:!0});function p(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function S(d){if(d.ep)return;d.ep=!0;const h=p(d);fetch(d.href,h)}})();var $={},J;function K(){return J||(J=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.countMap=n.Random=n.phi=n.radiansPerDegree=n.degreesPerRadian=n.FULL_CIRCLE=n.FIGURE_SPACE=n.NON_BREAKING_SPACE=n.MIN_DATE=n.MAX_DATE=n.csvStringToArray=void 0,n.assertClass=a,n.assertNonNullable=p,n.sleep=S,n.testXml=d,n.parseXml=h,n.followPath=o,n.getAttribute=g,n.parseFloatX=y,n.parseIntX=T,n.parseTimeT=N,n.pickAny=k,n.pick=B,n.take=f,n.filterMap=s,n.makePromise=c,n.dateIsValid=m,n.angleBetween=w,n.positiveModulo=E,n.rotateArray=R,n.rectUnion=G,n.rectAddPoint=ne,n.dateToFileName=re,n.lerp=ie,n.assertFinite=oe,n.shuffleArray=se,n.zip=ae,n.count=ce,n.initializedArray=z,n.sum=le,n.makeLinear=ue,n.makeBoundedLinear=de,n.polarToRectangular=fe,n.permutations=V,n.gcd=O,n.lcm=he;function a(e,t,i="Assertion Failed."){const r=u=>{throw new Error(`${i}  Expected type:  ${t.name}.  Found type:  ${u}.`)};if(e===null)r("null");else if(typeof e!="object")r(typeof e);else if(!(e instanceof t))r(e.constructor.name);else return e;throw new Error("wtf")}function p(e){if(e==null)throw new Error("wtf");return e}function S(e){return new Promise(t=>{setTimeout(t,e)})}function d(e){const i=new DOMParser().parseFromString(e,"application/xml");for(const r of Array.from(i.querySelectorAll("parsererror")))if(r instanceof HTMLElement)return{error:r};return{parsed:i}}function h(e){if(e!==void 0){const{parsed:t}=d(e);return t?.documentElement}}function o(e,...t){for(const i of t){if(e===void 0)return;if(typeof i=="number")e=e.children[i];else{const r=e.getElementsByTagName(i);if(r.length!=1)return;e=r[0]}}return e}function g(e,t,...i){if(t=o(t,...i),t!==void 0&&t.hasAttribute(e))return t.getAttribute(e)??void 0}function y(e){if(e==null)return;const t=+e;if(isFinite(t))return t}function T(e){const t=y(e);if(t!==void 0)return t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER||t!=Math.floor(t)?void 0:t}function N(e){if(typeof e=="string"&&(e=T(e)),e!=null&&!(e<=0))return new Date(e*1e3)}const A=e=>{const t=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,i=[[]];let r;for(;r=t.exec(e);)r[1].length&&r[1]!==","&&i.push([]),i[i.length-1].push(r[2]!==void 0?r[2].replace(/""/g,'"'):r[3]);return i};n.csvStringToArray=A;function k(e){const t=e.values().next();if(!t.done)return t.value}function B(e){if(e.length==0)throw new Error("wtf");return e[Math.random()*e.length|0]}function f(e){if(e.length<1)throw new Error("wtf");const t=Math.random()*e.length|0;return e.splice(t,1)[0]}function s(e,t){const i=[];return e.forEach((r,u)=>{const l=t(r,u);l!==void 0&&i.push(l)}),i}function c(){let e,t;return{promise:new Promise((r,u)=>{e=r,t=u}),resolve:e,reject:t}}n.MAX_DATE=new Date(864e13),n.MIN_DATE=new Date(-864e13);function m(e){return isFinite(e.getTime())}n.NON_BREAKING_SPACE=" ",n.FIGURE_SPACE=" ",n.FULL_CIRCLE=2*Math.PI,n.degreesPerRadian=360/n.FULL_CIRCLE,n.radiansPerDegree=n.FULL_CIRCLE/360,n.phi=(1+Math.sqrt(5))/2;function w(e,t){const i=E(e,n.FULL_CIRCLE);let u=E(t,n.FULL_CIRCLE)-i;const l=n.FULL_CIRCLE/2;if(u>l?u-=n.FULL_CIRCLE:u<-l&&(u+=n.FULL_CIRCLE),Math.abs(u)>l)throw new Error("wtf");return u}function E(e,t){const i=e%t;return i<0?i+Math.abs(t):i}function R(e,t){if((t|0)!=t)throw new Error(`invalid input: ${t}`);return t=E(t,e.length),t==0?e:[...e.slice(t),...e.slice(0,t)]}class te{constructor(){throw new Error("wtf")}static sfc32(t,i,r,u){function l(){t|=0,i|=0,r|=0,u|=0;let v=(t+i|0)+u|0;return u=u+1|0,t=i^i>>>9,i=r+(r<<3)|0,r=r<<21|r>>>11,r=r+v|0,(v>>>0)/4294967296}const M=l;return Object.defineProperty(M,"currentSeed",{get(){return JSON.stringify([t,i,r,u])}}),M}static#e=42;static seedIsValid(t){try{return this.create(t),!0}catch{return!1}}static create(t=this.newSeed()){console.info(t);const i=JSON.parse(t);if(!(i instanceof Array))throw new Error("invalid input");if(i.length!=4)throw new Error("invalid input");const[r,u,l,M]=i;if(!(typeof r=="number"&&typeof u=="number"&&typeof l=="number"&&typeof M=="number"))throw new Error("invalid input");return this.sfc32(r,u,l,M)}static newSeed(){const t=[];return t.push(Date.now()|0),t.push(this.#e++|0),t.push(Math.random()*2**31|0),t.push(performance.now()*1e4|0),JSON.stringify(t)}static fromString(t){try{return this.create(t)}catch{return this.create(this.anyStringToSeed(t))}}static anyStringToSeed(t){function i(l,M){return(l<<M|l>>>32-M)>>>0}const r=[2654435769,608135816,2242054355,320440878];return new TextEncoder().encode(t).forEach(l=>{r[0]^=l,r[0]=i(r[0],3),r[1]^=l,r[1]=i(r[1],5),r[2]^=l,r[2]=i(r[2],7),r[3]^=l,r[3]=i(r[3],11)}),r[0]^=i(r[1],7),r[1]^=i(r[2],11),r[2]^=i(r[3],13),r[3]^=i(r[0],17),JSON.stringify(r)}static test(){const r=[this.create()];for(;r.length<=10;){for(let l=0;l<20;l++){const M=r.map(v=>v());for(let v=1;v<M.length;v++)if(M[v]!==M[0]){debugger;throw new Error("wtf")}}const u=B(r).currentSeed;r.forEach(l=>{if(l.currentSeed!=u){debugger;throw new Error("wtf")}}),r.push(this.create(u))}}}n.Random=te;function G(e,t){const i=Math.min(e.x,t.x),r=Math.min(e.y,t.y),u=Math.max(e.x+e.width,t.x+t.width),l=Math.max(e.y+e.height,t.y+t.height),M=u-i,v=l-r;return{x:i,y:r,width:M,height:v}}function ne(e,t,i){return G(e,{x:t,y:i,width:0,height:0})}function re(e){return isNaN(e.getTime())?"0000⸱00⸱00 00⦂00⦂00":`${e.getFullYear().toString().padStart(4,"0")}⸱${(e.getMonth()+1).toString().padStart(2,"0")}⸱${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}⦂${e.getMinutes().toString().padStart(2,"0")}⦂${e.getSeconds().toString().padStart(2,"0")}`}function ie(e,t,i){return e+(t-e)*i}function oe(...e){e.forEach(t=>{if(!Number.isFinite(t))throw new Error("wtf")})}function se(e){for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function*ae(...e){const t=e.map(i=>i[Symbol.iterator]());for(;;){const i=t.map(r=>r.next());if(i.some(({done:r})=>r))break;yield i.map(({value:r})=>r)}}function*ce(e=0,t=1/0,i=1){for(let r=e;r<t;r+=i)yield r}function z(e,t){const i=[];for(let r=0;r<e;r++)i.push(t(r));return i}n.countMap=z;function le(e){return e.reduce((t,i)=>t+i,0)}function ue(e,t,i,r){const u=(r-t)/(i-e);return function(l){return(l-e)*u+t}}function de(e,t,i,r){i<e&&([e,t,i,r]=[i,r,e,t]);const u=(r-t)/(i-e);return function(l){return l<=e?t:l>=i?r:(l-e)*u+t}}function fe(e,t){return{x:Math.cos(t)*e,y:Math.sin(t)*e}}function*V(e,t=[]){if(e.length==0)yield t;else for(let i=0;i<e.length;i++){const r=e[i],u=[...t,r],l=[...e.slice(0,i),...e.slice(i+1)];yield*V(l,u)}}function O(e,t){return t?O(t,e%t):e}function he(e,t){return e*t/O(e,t)}})($)),$}var C=K(),L={},Q;function me(){if(Q)return L;Q=1,Object.defineProperty(L,"__esModule",{value:!0}),L.AnimationLoop=void 0,L.getById=a,L.selectorQueryAll=p,L.querySelectorAll=S,L.selectorQuery=d,L.querySelector=h,L.loadDateTimeLocal=o,L.getBlobFromCanvas=g,L.getAudioBalanceControl=y,L.getHashInfo=T,L.createElementFromHTML=N,L.download=A,L.getDataUrl=B;const n=K();function a(f,s){const c=document.getElementById(f);if(!c)throw new Error("Could not find element with id "+f+".  Expected type:  "+s.name);if(c instanceof s)return c;throw new Error("Element with id "+f+" has type "+c.constructor.name+".  Expected type:  "+s.name)}function p(f,s,c=1,m=1/0,w=document){const E=[];if(w.querySelectorAll(f).forEach(R=>{E.push((0,n.assertClass)(R,s))}),E.length<c||E.length>m)throw new Error(`Expecting "${f}" to return [${c} - ${m}] instances of ${s.name}, found ${E.length}.`);return E}function S(f,s,c=1,m=1/0,w=document){const E=[];if(w.querySelectorAll(f).forEach(R=>{E.push((0,n.assertClass)(R,s))}),E.length<c||E.length>m)throw new Error(`Expecting "${f}" to return [${c} - ${m}] instances of ${s.name}, found ${E.length}.`);return E}function d(f,s,c=document){return p(f,s,1,1,c)[0]}function h(f,s,c=document){return S(f,s,1,1,c)[0]}function o(f,s,c="milliseconds"){let m;switch(c){case"minutes":{m=s.getSeconds()*1e3+s.getMilliseconds();break}case"seconds":{m=s.getMilliseconds();break}case"milliseconds":{m=0;break}default:throw new Error("wtf")}f.valueAsNumber=+s-s.getTimezoneOffset()*6e4-m}function g(f){const{reject:s,resolve:c,promise:m}=(0,n.makePromise)();return f.toBlob(w=>{w?c(w):s(new Error("blob is null!"))}),m}function y(f){const s=new AudioContext,c=s.createMediaElementSource(f),m=new StereoPannerNode(s,{pan:0});return c.connect(m).connect(s.destination),w=>{m.pan.value=w}}function T(){const f=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(m=>{const w=m.split("=",2);if(w.length==2){const E=decodeURIComponent(w[0]),R=decodeURIComponent(w[1]);f.set(E,R)}}),f}function N(f,s){var c=document.createElement("div");return c.innerHTML=f.trim(),(0,n.assertClass)(c.firstChild,s,"createElementFromHTML:")}function A(f,s){var c=document.createElement("a");if(c.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(s)),c.setAttribute("download",f),document.createEvent){var m=document.createEvent("MouseEvents");m.initEvent("click",!0,!0),c.dispatchEvent(m)}else c.click()}class k{onWake;constructor(s){this.onWake=s,this.callback=this.callback.bind(this),requestAnimationFrame(this.callback)}#e=!1;cancel(){this.#e=!0}callback(s){this.#e||(requestAnimationFrame(this.callback),this.onWake(s))}}L.AnimationLoop=k;async function B(f){const s=document.createElement("img");s.src=f,await s.decode();const c=s.naturalHeight,m=s.naturalWidth;if(c==0||m==0)throw new Error("problem with image");const w=document.createElement("canvas");w.width=m,w.height=c;const E=w.getContext("2d");if(!E)throw new Error("wtf");return E.drawImage(s,0,0,w.width,w.height),w.toDataURL()}return L}var I=me();const D=I.getById("d-far",HTMLInputElement),U=I.getById("d-near",HTMLInputElement),X=I.getById("progress",HTMLInputElement),Y=I.getById("precision",HTMLSelectElement),Z=I.getById("split-count",HTMLSelectElement),_=I.getById("split-result",HTMLTableElement),x=I.getById("larger-count",HTMLSelectElement),ge=I.getById("larger-copies",HTMLSpanElement),ee=I.getById("smaller-count",HTMLSelectElement),pe=I.getById("smaller-copies",HTMLSpanElement),F=I.getById("extended-result",HTMLTableElement),we=I.getById("smallest-legal-progress",HTMLSpanElement),W=I.getById("specific-point-result",HTMLTableCellElement);function b(n,a){function p(){a.innerText="invalid"}function S(){return!(n===void 0||!isFinite(n))}function d(o){if(!S())p();else{const g=n.toFixed(o);a.innerText=g}}function h(o){if(!S())p();else{let g=o;const y=Math.round(n*g);let T=Math.abs(y)%g;const N=(Math.abs(y)-T)/g;if(T==0)d(0);else{for(;T%2==0;)T/=2,g/=2;const A=document.createElement("span");A.classList.add("numerator"),A.innerText=T.toString();const k=document.createElement("span");k.classList.add("denominator"),k.innerText=g.toString(),a.innerHTML="",y<0&&a.append("-"),N!=0&&a.append(N.toString()," "),a.append(A,"/",k)}}}if(!S())p();else switch(Y.selectedOptions[0].value){case"0.1":{d(1);break}case"0.01":{d(2);break}case"0.001":{d(3);break}case"0.0001":{d(4);break}case"1/2":{h(2);break}case"1/4":{h(4);break}case"1/8":{h(8);break}case"1/16":{h(16);break}case"1/32":{h(32);break}case"1/64":{h(64);break}case"full":{a.innerText=C.assertNonNullable(n).toString();break}default:throw new Error(`wtf (${n})`)}}function P(n,a,p){if(n<=a||a<=0)return;const S=(1-p)*a+p*n;if(!(S<=0))return n*a/S}function Ee(n,a){if(!(n===void 0||a===void 0)&&!(n<=a||a<=0))return a/(a-n)}function q(n){const p=/^ *(-)?(\d+ +)?(\d+) *\/ *(\d+) *$/.exec(n);if(p){const[,S,d,h,o]=p,g=d===void 0?0:C.assertNonNullable(C.parseIntX(d)),y=C.assertNonNullable(C.parseIntX(h)),T=C.assertNonNullable(C.parseIntX(o)),N=S==="-"?-1:1;return T==0?void 0:N*(g+y/T)}else return C.parseFloatX(n)}function H(n){const a=n.value,p=q(a);return p===void 0?n.style.backgroundColor="pink":n.style.backgroundColor="",p}function j(){const n=H(D),a=H(U),p=H(X);b(void 0,W),b(Ee(n,a),we),_.innerHTML="",F.innerHTML="";function S(o,g){const y=o==1?"copy":"copies";g.innerText=y}const d=C.assertNonNullable(C.parseIntX(x.selectedOptions[0].value));S(d,ge);const h=C.assertNonNullable(C.parseIntX(ee.selectedOptions[0].value));if(S(h,pe),!(n===void 0||a===void 0)){{let o=_.insertRow();o.insertCell().innerText="Far",b(n,o.insertCell());const g=C.assertNonNullable(C.parseIntX(Z.selectedOptions[0].value));for(let y=1;y<g;y++)o=_.insertRow(),o.insertCell().innerText=y.toString(),b(P(n,a,y/g),o.insertCell());o=_.insertRow(),o.insertCell().innerText="Near",b(a,o.insertCell())}for(let o=d;o>0;o--){const g=F.insertRow();g.insertCell().innerText=o.toString(),b(P(n,a,-o),g.insertCell())}{const o=F.insertRow();o.insertCell().innerText="Far",b(n,o.insertCell())}{const o=F.insertRow();o.insertCell().innerText="Near",b(a,o.insertCell())}for(let o=0;o<h;o++){const g=F.insertRow();g.insertCell().innerText=(o+1).toString(),b(P(n,a,o+2),g.insertCell())}b(p===void 0?void 0:P(n,a,p),W)}}j();[D,U,X,Y,Z,x,ee].forEach(n=>{n.addEventListener("input",j)});I.querySelectorAll("[data-fraction]",HTMLSpanElement).forEach(n=>{const a=q(C.assertNonNullable(n.dataset.fraction));a===void 0&&console.error(n),b(a,n)});window.PHIL={dFarInput:D,dNearInput:U,progressInput:X,parseFraction:q,getNumberValue:H,findPerspectivePoint:P,updateDisplay:j};
