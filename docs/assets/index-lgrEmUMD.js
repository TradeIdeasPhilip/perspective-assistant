(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))p(l);new MutationObserver(l=>{for(const m of l)if(m.type==="childList")for(const s of m.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&p(s)}).observe(document,{childList:!0,subtree:!0});function g(l){const m={};return l.integrity&&(m.integrity=l.integrity),l.referrerPolicy&&(m.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?m.credentials="include":l.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function p(l){if(l.ep)return;l.ep=!0;const m=g(l);fetch(l.href,m)}})();var V={},ne;function ae(){return ne||(ne=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.countMap=n.Random=n.phi=n.radiansPerDegree=n.degreesPerRadian=n.FULL_CIRCLE=n.FIGURE_SPACE=n.NON_BREAKING_SPACE=n.MIN_DATE=n.MAX_DATE=n.csvStringToArray=void 0,n.assertClass=o,n.assertNonNullable=g,n.sleep=p,n.testXml=l,n.parseXml=m,n.followPath=s,n.getAttribute=w,n.parseFloatX=E,n.parseIntX=T,n.parseTimeT=A,n.pickAny=P,n.pick=F,n.take=c,n.filterMap=a,n.makePromise=u,n.dateIsValid=h,n.angleBetween=S,n.positiveModulo=L,n.rotateArray=R,n.rectUnion=x,n.rectAddPoint=he,n.dateToFileName=pe,n.lerp=we,n.assertFinite=Ee,n.shuffleArray=ye,n.zip=Se,n.count=Le,n.initializedArray=ee,n.sum=Te,n.makeLinear=Ce,n.makeBoundedLinear=Me,n.polarToRectangular=Ie,n.permutations=te,n.gcd=G,n.lcm=be;function o(e,t,i="Assertion Failed."){const r=d=>{throw new Error(`${i}  Expected type:  ${t.name}.  Found type:  ${d}.`)};if(e===null)r("null");else if(typeof e!="object")r(typeof e);else if(!(e instanceof t))r(e.constructor.name);else return e;throw new Error("wtf")}function g(e){if(e==null)throw new Error("wtf");return e}function p(e){return new Promise(t=>{setTimeout(t,e)})}function l(e){const i=new DOMParser().parseFromString(e,"application/xml");for(const r of Array.from(i.querySelectorAll("parsererror")))if(r instanceof HTMLElement)return{error:r};return{parsed:i}}function m(e){if(e!==void 0){const{parsed:t}=l(e);return t?.documentElement}}function s(e,...t){for(const i of t){if(e===void 0)return;if(typeof i=="number")e=e.children[i];else{const r=e.getElementsByTagName(i);if(r.length!=1)return;e=r[0]}}return e}function w(e,t,...i){if(t=s(t,...i),t!==void 0&&t.hasAttribute(e))return t.getAttribute(e)??void 0}function E(e){if(e==null)return;const t=+e;if(isFinite(t))return t}function T(e){const t=E(e);if(t!==void 0)return t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER||t!=Math.floor(t)?void 0:t}function A(e){if(typeof e=="string"&&(e=T(e)),e!=null&&!(e<=0))return new Date(e*1e3)}const N=e=>{const t=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,i=[[]];let r;for(;r=t.exec(e);)r[1].length&&r[1]!==","&&i.push([]),i[i.length-1].push(r[2]!==void 0?r[2].replace(/""/g,'"'):r[3]);return i};n.csvStringToArray=N;function P(e){const t=e.values().next();if(!t.done)return t.value}function F(e){if(e.length==0)throw new Error("wtf");return e[Math.random()*e.length|0]}function c(e){if(e.length<1)throw new Error("wtf");const t=Math.random()*e.length|0;return e.splice(t,1)[0]}function a(e,t){const i=[];return e.forEach((r,d)=>{const f=t(r,d);f!==void 0&&i.push(f)}),i}function u(){let e,t;return{promise:new Promise((r,d)=>{e=r,t=d}),resolve:e,reject:t}}n.MAX_DATE=new Date(864e13),n.MIN_DATE=new Date(-864e13);function h(e){return isFinite(e.getTime())}n.NON_BREAKING_SPACE=" ",n.FIGURE_SPACE=" ",n.FULL_CIRCLE=2*Math.PI,n.degreesPerRadian=360/n.FULL_CIRCLE,n.radiansPerDegree=n.FULL_CIRCLE/360,n.phi=(1+Math.sqrt(5))/2;function S(e,t){const i=L(e,n.FULL_CIRCLE);let d=L(t,n.FULL_CIRCLE)-i;const f=n.FULL_CIRCLE/2;if(d>f?d-=n.FULL_CIRCLE:d<-f&&(d+=n.FULL_CIRCLE),Math.abs(d)>f)throw new Error("wtf");return d}function L(e,t){const i=e%t;return i<0?i+Math.abs(t):i}function R(e,t){if((t|0)!=t)throw new Error(`invalid input: ${t}`);return t=L(t,e.length),t==0?e:[...e.slice(t),...e.slice(0,t)]}class ge{constructor(){throw new Error("wtf")}static sfc32(t,i,r,d){function f(){t|=0,i|=0,r|=0,d|=0;let v=(t+i|0)+d|0;return d=d+1|0,t=i^i>>>9,i=r+(r<<3)|0,r=r<<21|r>>>11,r=r+v|0,(v>>>0)/4294967296}const I=f;return Object.defineProperty(I,"currentSeed",{get(){return JSON.stringify([t,i,r,d])}}),I}static#e=42;static seedIsValid(t){try{return this.create(t),!0}catch{return!1}}static create(t=this.newSeed()){console.info(t);const i=JSON.parse(t);if(!(i instanceof Array))throw new Error("invalid input");if(i.length!=4)throw new Error("invalid input");const[r,d,f,I]=i;if(!(typeof r=="number"&&typeof d=="number"&&typeof f=="number"&&typeof I=="number"))throw new Error("invalid input");return this.sfc32(r,d,f,I)}static newSeed(){const t=[];return t.push(Date.now()|0),t.push(this.#e++|0),t.push(Math.random()*2**31|0),t.push(performance.now()*1e4|0),JSON.stringify(t)}static fromString(t){try{return this.create(t)}catch{return this.create(this.anyStringToSeed(t))}}static anyStringToSeed(t){function i(f,I){return(f<<I|f>>>32-I)>>>0}const r=[2654435769,608135816,2242054355,320440878];return new TextEncoder().encode(t).forEach(f=>{r[0]^=f,r[0]=i(r[0],3),r[1]^=f,r[1]=i(r[1],5),r[2]^=f,r[2]=i(r[2],7),r[3]^=f,r[3]=i(r[3],11)}),r[0]^=i(r[1],7),r[1]^=i(r[2],11),r[2]^=i(r[3],13),r[3]^=i(r[0],17),JSON.stringify(r)}static test(){const r=[this.create()];for(;r.length<=10;){for(let f=0;f<20;f++){const I=r.map(v=>v());for(let v=1;v<I.length;v++)if(I[v]!==I[0]){debugger;throw new Error("wtf")}}const d=F(r).currentSeed;r.forEach(f=>{if(f.currentSeed!=d){debugger;throw new Error("wtf")}}),r.push(this.create(d))}}}n.Random=ge;function x(e,t){const i=Math.min(e.x,t.x),r=Math.min(e.y,t.y),d=Math.max(e.x+e.width,t.x+t.width),f=Math.max(e.y+e.height,t.y+t.height),I=d-i,v=f-r;return{x:i,y:r,width:I,height:v}}function he(e,t,i){return x(e,{x:t,y:i,width:0,height:0})}function pe(e){return isNaN(e.getTime())?"0000⸱00⸱00 00⦂00⦂00":`${e.getFullYear().toString().padStart(4,"0")}⸱${(e.getMonth()+1).toString().padStart(2,"0")}⸱${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}⦂${e.getMinutes().toString().padStart(2,"0")}⦂${e.getSeconds().toString().padStart(2,"0")}`}function we(e,t,i){return e+(t-e)*i}function Ee(...e){e.forEach(t=>{if(!Number.isFinite(t))throw new Error("wtf")})}function ye(e){for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function*Se(...e){const t=e.map(i=>i[Symbol.iterator]());for(;;){const i=t.map(r=>r.next());if(i.some(({done:r})=>r))break;yield i.map(({value:r})=>r)}}function*Le(e=0,t=1/0,i=1){for(let r=e;r<t;r+=i)yield r}function ee(e,t){const i=[];for(let r=0;r<e;r++)i.push(t(r));return i}n.countMap=ee;function Te(e){return e.reduce((t,i)=>t+i,0)}function Ce(e,t,i,r){const d=(r-t)/(i-e);return function(f){return(f-e)*d+t}}function Me(e,t,i,r){i<e&&([e,t,i,r]=[i,r,e,t]);const d=(r-t)/(i-e);return function(f){return f<=e?t:f>=i?r:(f-e)*d+t}}function Ie(e,t){return{x:Math.cos(t)*e,y:Math.sin(t)*e}}function*te(e,t=[]){if(e.length==0)yield t;else for(let i=0;i<e.length;i++){const r=e[i],d=[...t,r],f=[...e.slice(0,i),...e.slice(i+1)];yield*te(f,d)}}function G(e,t){return t?G(t,e%t):e}function be(e,t){return e*t/G(e,t)}})(V)),V}var C=ae(),M={},re;function ve(){if(re)return M;re=1,Object.defineProperty(M,"__esModule",{value:!0}),M.AnimationLoop=void 0,M.getById=o,M.selectorQueryAll=g,M.querySelectorAll=p,M.selectorQuery=l,M.querySelector=m,M.loadDateTimeLocal=s,M.getBlobFromCanvas=w,M.getAudioBalanceControl=E,M.getHashInfo=T,M.createElementFromHTML=A,M.download=N,M.getDataUrl=F;const n=ae();function o(c,a){const u=document.getElementById(c);if(!u)throw new Error("Could not find element with id "+c+".  Expected type:  "+a.name);if(u instanceof a)return u;throw new Error("Element with id "+c+" has type "+u.constructor.name+".  Expected type:  "+a.name)}function g(c,a,u=1,h=1/0,S=document){const L=[];if(S.querySelectorAll(c).forEach(R=>{L.push((0,n.assertClass)(R,a))}),L.length<u||L.length>h)throw new Error(`Expecting "${c}" to return [${u} - ${h}] instances of ${a.name}, found ${L.length}.`);return L}function p(c,a,u=1,h=1/0,S=document){const L=[];if(S.querySelectorAll(c).forEach(R=>{L.push((0,n.assertClass)(R,a))}),L.length<u||L.length>h)throw new Error(`Expecting "${c}" to return [${u} - ${h}] instances of ${a.name}, found ${L.length}.`);return L}function l(c,a,u=document){return g(c,a,1,1,u)[0]}function m(c,a,u=document){return p(c,a,1,1,u)[0]}function s(c,a,u="milliseconds"){let h;switch(u){case"minutes":{h=a.getSeconds()*1e3+a.getMilliseconds();break}case"seconds":{h=a.getMilliseconds();break}case"milliseconds":{h=0;break}default:throw new Error("wtf")}c.valueAsNumber=+a-a.getTimezoneOffset()*6e4-h}function w(c){const{reject:a,resolve:u,promise:h}=(0,n.makePromise)();return c.toBlob(S=>{S?u(S):a(new Error("blob is null!"))}),h}function E(c){const a=new AudioContext,u=a.createMediaElementSource(c),h=new StereoPannerNode(a,{pan:0});return u.connect(h).connect(a.destination),S=>{h.pan.value=S}}function T(){const c=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(h=>{const S=h.split("=",2);if(S.length==2){const L=decodeURIComponent(S[0]),R=decodeURIComponent(S[1]);c.set(L,R)}}),c}function A(c,a){var u=document.createElement("div");return u.innerHTML=c.trim(),(0,n.assertClass)(u.firstChild,a,"createElementFromHTML:")}function N(c,a){var u=document.createElement("a");if(u.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(a)),u.setAttribute("download",c),document.createEvent){var h=document.createEvent("MouseEvents");h.initEvent("click",!0,!0),u.dispatchEvent(h)}else u.click()}class P{onWake;constructor(a){this.onWake=a,this.callback=this.callback.bind(this),requestAnimationFrame(this.callback)}#e=!1;cancel(){this.#e=!0}callback(a){this.#e||(requestAnimationFrame(this.callback),this.onWake(a))}}M.AnimationLoop=P;async function F(c){const a=document.createElement("img");a.src=c,await a.decode();const u=a.naturalHeight,h=a.naturalWidth;if(u==0||h==0)throw new Error("problem with image");const S=document.createElement("canvas");S.width=h,S.height=u;const L=S.getContext("2d");if(!L)throw new Error("wtf");return L.drawImage(a,0,0,S.width,S.height),S.toDataURL()}return M}var y=ve();const Ae=.2,q=1,_=1,H=3.25,j=2,z=8,U=2.5,Ne=z-j,ce=z-q,Fe=z-Ae;function ie(n){return(n-U)*Fe/ce+U}function D(n){return(n-U)*Ne/ce+U}function Re(){const n=y.getById("sample-polygon",SVGPolygonElement),o=`${q},${_} ${q},${H} ${j},${D(H)} ${j},${D(_)}`;n.setAttribute("points",o);const g=y.getById("top-fixed",SVGLineElement);g.y1.baseVal.value=ie(_);const p=y.getById("bottom-fixed",SVGLineElement);p.y1.baseVal.value=ie(H);const l=y.getById("far-text",SVGTextElement),m=(_+H)/2;l.style.setProperty("--center-y",`${m}px`),y.getById("near-text",SVGTextElement).style.setProperty("--center-y",`${D(m)}px`)}Re();const Pe=y.getById("to-near",SVGLineElement),ke=y.getById("to-far",SVGLineElement);function le(n){const o=D(n);ke.y1.baseVal.value=n,Pe.y1.baseVal.value=o}window.setMeasurementAngle=le;const Be=C.Random.fromString("Random1"),B=C.initializedArray(20,()=>Be()*4+.5);B.push;const $e=3e3,Y=250,oe=$e+Y;function _e(n){const o=Math.floor(n/oe),g=B[o%B.length],p=B[(o+1)%B.length],l=n-o*oe,m=l<Y?C.lerp(g,p,l/Y):p;le(m)}new y.AnimationLoop(_e);const W=y.getById("d-far",HTMLInputElement),J=y.getById("d-near",HTMLInputElement),Q=y.getById("progress",HTMLInputElement),ue=y.getById("precision",HTMLSelectElement),fe=y.getById("split-count",HTMLSelectElement),O=y.getById("split-result",HTMLTableElement),de=y.getById("larger-count",HTMLSelectElement),He=y.getById("larger-copies",HTMLSpanElement),me=y.getById("smaller-count",HTMLSelectElement),Oe=y.getById("smaller-copies",HTMLSpanElement),k=y.getById("extended-result",HTMLTableElement),De=y.getById("smallest-legal-progress",HTMLSpanElement),se=y.getById("specific-point-result",HTMLTableCellElement);function b(n,o){function g(){o.innerText="invalid"}function p(){return!(n===void 0||!isFinite(n))}function l(E,T){return E.toLocaleString("en-US",{minimumFractionDigits:T,maximumFractionDigits:T,useGrouping:!0})}function m(E){return E.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:20,useGrouping:!0})}function s(E){if(!p())g();else{const T=l(n,E);o.innerText=T}}function w(E){if(!p())g();else{let T=E;const A=Math.round(n*T);let N=Math.abs(A)%T;const P=(Math.abs(A)-N)/T;if(N==0)s(0);else{for(;N%2==0;)N/=2,T/=2;const F=document.createElement("span");F.classList.add("numerator"),F.innerText=N.toString();const c=document.createElement("span");c.classList.add("denominator"),c.innerText=T.toString(),o.innerHTML="",A<0&&o.append("-"),P!=0&&o.append(l(P,0)," "),o.append(F,"/",c)}}}if(!p())g();else switch(ue.selectedOptions[0].value){case"0.1":{s(1);break}case"0.01":{s(2);break}case"0.001":{s(3);break}case"0.0001":{s(4);break}case"1/2":{w(2);break}case"1/4":{w(4);break}case"1/8":{w(8);break}case"1/16":{w(16);break}case"1/32":{w(32);break}case"1/64":{w(64);break}case"full":{o.innerText=m(C.assertNonNullable(n));break}default:throw new Error(`wtf (${n})`)}}function $(n,o,g){if(n<=o||o<=0)return;const p=(1-g)*o+g*n;if(!(p<=0))return n*o/p}function Xe(n,o){if(!(n===void 0||o===void 0)&&!(n<=o||o<=0))return o/(o-n)}function K(n){const g=/^ *(-)?(\d+ +)?(\d+) *\/ *(\d+) *$/.exec(n);if(g){const[,p,l,m,s]=g,w=l===void 0?0:C.assertNonNullable(C.parseIntX(l)),E=C.assertNonNullable(C.parseIntX(m)),T=C.assertNonNullable(C.parseIntX(s)),A=p==="-"?-1:1;return T==0?void 0:A*(w+E/T)}else return C.parseFloatX(n)}function X(n){const o=n.value,g=K(o);return g===void 0?n.style.backgroundColor="pink":n.style.backgroundColor="",g}function Z(){const n=X(W),o=X(J),g=X(Q);b(void 0,se),b(Xe(n,o),De),O.innerHTML="",k.innerHTML="";function p(s,w){const E=s==1?"copy":"copies";w.innerText=E}const l=C.assertNonNullable(C.parseIntX(de.selectedOptions[0].value));p(l,He);const m=C.assertNonNullable(C.parseIntX(me.selectedOptions[0].value));if(p(m,Oe),!(n===void 0||o===void 0)){{let s=O.insertRow();s.insertCell().innerText="Far",b(n,s.insertCell());const w=C.assertNonNullable(C.parseIntX(fe.selectedOptions[0].value));for(let E=1;E<w;E++)s=O.insertRow(),s.insertCell().innerText=E.toString(),b($(n,o,E/w),s.insertCell());s=O.insertRow(),s.insertCell().innerText="Near",b(o,s.insertCell())}for(let s=l;s>0;s--){const w=k.insertRow();w.insertCell().innerText=s.toString(),b($(n,o,-s),w.insertCell())}{const s=k.insertRow();s.insertCell().innerText="Far",b(n,s.insertCell())}{const s=k.insertRow();s.insertCell().innerText="Near",b(o,s.insertCell())}for(let s=0;s<m;s++){const w=k.insertRow();w.insertCell().innerText=(s+1).toString(),b($(n,o,s+2),w.insertCell())}b(g===void 0?void 0:$(n,o,g),se)}}Z();[W,J,Q,ue,fe,de,me].forEach(n=>{n.addEventListener("input",Z)});y.querySelectorAll("[data-fraction]",HTMLSpanElement).forEach(n=>{const o=K(C.assertNonNullable(n.dataset.fraction));o===void 0&&console.error(n),b(o,n)});window.PHIL={dFarInput:W,dNearInput:J,progressInput:Q,parseFraction:K,getNumberValue:X,findPerspectivePoint:$,updateDisplay:Z};
